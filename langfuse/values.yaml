# Langfuse Helm Chart Values
# Documentation: https://langfuse.com/self-hosting/deployment/kubernetes-helm

langfuse:
  service:
    type: ClusterIP
    port: 3000

  # Security configurations - secrets managed via External Secrets Operator
  nextauth:
    url: "https://langfuse.k.shion1305.com"
    secret:
      existingSecret: "langfuse-credentials"
      existingSecretKey: "NEXTAUTH_SECRET"

  salt:
    existingSecret: "langfuse-credentials"
    existingSecretKey: "SALT"

  encryptionKey:
    existingSecret: "langfuse-credentials"
    existingSecretKey: "ENCRYPTION_KEY"

  # Resource limits
  resources:
    web:
      requests:
        cpu: 500m
        memory: 1Gi
      limits:
        cpu: 2000m
        memory: 2Gi
    worker:
      requests:
        cpu: 250m
        memory: 512Mi
      limits:
        cpu: 1000m
        memory: 1Gi

# PostgreSQL - use external PostgreSQL managed by postgres-operator
postgresql:
  enabled: false

# External PostgreSQL configuration
externalDatabase:
  enabled: true
  host: "langfuse.postgres-clusters.svc.cluster.local"
  port: 5432
  database: "langfuse"
  existingSecret: "langfuse-credentials"
  existingSecretPasswordKey: "DB_PASSWORD"
  existingSecretUsernameKey: "DB_USER"

# ClickHouse - embedded deployment
clickhouse:
  enabled: true
  auth:
    existingSecret: "langfuse-credentials"
    existingSecretKey: "CLICKHOUSE_PASSWORD"
  persistence:
    enabled: true
    size: 20Gi
    storageClass: "longhorn-ssd"
  resources:
    requests:
      cpu: 500m
      memory: 1Gi
    limits:
      cpu: 2000m
      memory: 4Gi

# Redis - embedded deployment
redis:
  enabled: true
  auth:
    enabled: true
    existingSecret: "langfuse-credentials"
    existingSecretPasswordKey: "REDIS_PASSWORD"
  master:
    persistence:
      enabled: true
      size: 5Gi
      storageClass: "longhorn-ssd"
    resources:
      requests:
        cpu: 100m
        memory: 256Mi
      limits:
        cpu: 500m
        memory: 512Mi

# S3-compatible storage (MinIO)
s3:
  enabled: true
  auth:
    existingSecret: "langfuse-credentials"
    existingSecretRootPasswordKey: "S3_ROOT_PASSWORD"
  persistence:
    enabled: true
    size: 50Gi
    storageClass: "longhorn-ssd"
  resources:
    requests:
      cpu: 250m
      memory: 512Mi
    limits:
      cpu: 1000m
      memory: 1Gi

# Ingress disabled - managed separately via nginx-ssl
ingress:
  enabled: false
